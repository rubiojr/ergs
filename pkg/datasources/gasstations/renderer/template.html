<div class="block-gasstations">
    {{$name := index .Metadata "name"}} {{$address := index .Metadata
    "address"}} {{$locality := index .Metadata "locality"}} {{$province := index
    .Metadata "province"}} {{$gasoline95 := index .Metadata "gasoline95"}}
    {{$diesel := index .Metadata "diesel"}} {{$gasoline98 := index .Metadata
    "gasoline98"}} {{$biodiesel := index .Metadata "biodiesel"}} {{$distance :=
    index .Metadata "distance"}} {{$latitude := index .Metadata "latitude"}}
    {{$longitude := index .Metadata "longitude"}}

    <div class="station-header">
        <div class="station-icon">⛽</div>

        <div class="station-content">
            <div class="station-title">
                <h3 class="station-name">
                    {{if $name}}{{$name}}{{else}}Gas Station{{end}}
                </h3>
                {{if and $distance (gt $distance 0)}}
                <span class="station-distance"
                    >{{printf "%.1f" $distance}} km</span
                >
                {{end}}
            </div>

            <div class="station-meta">
                <span class="station-time"
                    >{{formatTime .Block.CreatedAt}}</span
                >
                {{if $address}}
                <span class="station-separator">|</span>
                <span class="station-location">{{$address}}</span>
                {{end}} {{if $locality}}
                <span class="station-separator">|</span>
                <span class="station-locality">{{$locality}}</span>
                {{end}} {{if and $latitude $longitude}}
                <span class="station-separator">|</span>
                <a
                    href="https://www.google.com/maps?q={{$latitude}},{{$longitude}}"
                    target="_blank"
                    class="station-map"
                    >view map</a
                >
                {{end}}
            </div>
        </div>
    </div>

    <div class="fuel-prices">
        {{if and $gasoline95 (ne $gasoline95 "0") (ne $gasoline95 "")}}
        <div class="fuel-item fuel-95">
            <span class="fuel-type">95</span>
            <span class="fuel-price">{{$gasoline95}}€</span>
        </div>
        {{end}} {{if and $diesel (ne $diesel "0") (ne $diesel "")}}
        <div class="fuel-item fuel-diesel">
            <span class="fuel-type">Diesel</span>
            <span class="fuel-price">{{$diesel}}€</span>
        </div>
        {{end}} {{if and $gasoline98 (ne $gasoline98 "0") (ne $gasoline98 "")}}
        <div class="fuel-item fuel-98">
            <span class="fuel-type">98</span>
            <span class="fuel-price">{{$gasoline98}}€</span>
        </div>
        {{end}} {{if and $biodiesel (ne $biodiesel "0") (ne $biodiesel "")}}
        <div class="fuel-item fuel-bio">
            <span class="fuel-type">Bio</span>
            <span class="fuel-price">{{$biodiesel}}€</span>
        </div>
        {{end}}
    </div>
</div>

<style>
    .block-gasstations {
        margin-bottom: 1.5rem;
        padding: 0;
        border: 1px solid var(--border);
        border-radius: 6px;
        background: var(--surface);
        font-size: 13px;
        line-height: 1.3;
        transition:
            background 0.25s ease,
            border-color 0.25s ease;
    }

    .station-header {
        display: flex;
        gap: 10px;
        padding: 8px 12px;
        background: var(--surface-alt);
        border-radius: 6px 6px 0 0;
        transition: background 0.25s ease;
    }

    .station-header:hover {
        background: var(--surface);
    }

    .station-icon {
        font-size: 16px;
        margin-top: 2px;
        flex-shrink: 0;
    }

    .station-content {
        flex: 1;
        min-width: 0;
    }

    .station-title {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 4px;
        line-height: 1.2;
    }

    .station-name {
        margin: 0;
        color: var(--text);
        font-size: 14px;
        font-weight: 500;
    }

    .station-distance {
        background: var(--accent);
        color: var(--text);
        padding: 2px 6px;
        border-radius: 10px;
        font-size: 10px;
        font-weight: 600;
        border: 1px solid var(--accent-border);
    }

    .station-meta {
        color: var(--text-dim);
        font-size: 11px;
        display: flex;
        align-items: center;
        gap: 6px;
        flex-wrap: wrap;
    }

    .station-time {
        font-variant-numeric: tabular-nums;
        color: var(--text-faint);
    }

    .station-separator {
        color: var(--border-alt);
        margin: 0 2px;
    }

    .station-location,
    .station-locality {
        color: var(--text-dim);
    }

    .station-map {
        color: var(--text-dim);
        text-decoration: none;
        transition: color 0.2s ease;
    }

    .station-map:hover {
        text-decoration: underline;
        color: var(--accent);
    }

    .fuel-prices {
        display: flex;
        gap: 8px;
        padding: 8px 12px;
        background: var(--surface-alt);
        border-top: 1px solid var(--border);
        border-radius: 0 0 6px 6px;
        flex-wrap: wrap;
    }

    .fuel-item {
        display: flex;
        align-items: center;
        gap: 4px;
        padding: 4px 8px;
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: 12px;
        font-size: 11px;
        transition:
            background 0.2s ease,
            border-color 0.25s ease;
    }

    .fuel-item:hover {
        background: var(--surface-alt);
        border-color: var(--accent-border);
    }

    .fuel-type {
        font-weight: 600;
        color: var(--text-dim);
    }

    .fuel-price {
        font-weight: 700;
        color: var(--text);
    }

    /* Fuel-specific accent overrides */
    .fuel-95 .fuel-type {
        color: var(--success);
    }

    .fuel-diesel .fuel-type {
        color: var(--text-faint);
    }

    .fuel-98 .fuel-type {
        color: var(--accent);
    }

    .fuel-bio .fuel-type {
        color: var(--warn);
    }

    @media (max-width: 600px) {
        .station-header {
            padding: 8px 10px;
            gap: 8px;
        }

        .station-meta {
            font-size: 10px;
            flex-direction: column;
            align-items: flex-start;
            gap: 2px;
        }

        .station-separator {
            display: none;
        }

        .fuel-prices {
            gap: 6px;
            padding: 8px 10px;
        }

        .fuel-item {
            font-size: 10px;
            padding: 3px 6px;
        }
    }
</style>
