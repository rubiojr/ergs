<div class="block-hackernews">
    {{$itemType := index .Metadata "item_type" | default "story"}}
    {{$title := index .Metadata "title"}}
    {{$url := index .Metadata "url"}}
    {{$score := index .Metadata "score"}}
    {{$descendants := index .Metadata "descendants"}}
    {{$author := index .Metadata "author"}}
    {{$parentID := index .Metadata "parent_id"}}
    {{$itemText := index .Metadata "item_text"}}

    <div class="hn-header">
        <div class="hn-votes">
            {{if and $score (gt $score 0)}}
                <div class="vote-score">{{$score}}</div>
                <div class="vote-label">points</div>
            {{else}}
                <div class="vote-placeholder">•</div>
            {{end}}
        </div>

        <div class="hn-content">
            {{if $title}}
                <div class="hn-title">
                    {{if $url}}
                        <a href="{{$url}}" target="_blank" class="hn-link">{{$title}}</a>
                    {{else}}
                        <span class="hn-title-text">{{$title}}</span>
                    {{end}}
                </div>
            {{end}}

            <div class="hn-meta">
                {{if $author}}
                    <span class="hn-author">by {{$author}}</span>
                {{end}}
                <span class="hn-time">{{formatTime .Block.CreatedAt}}</span>
                {{if and $descendants (gt $descendants 0)}}
                    <span class="hn-separator">|</span>
                    <a href="https://news.ycombinator.com/item?id={{replace .Block.ID "hn-" ""}}" target="_blank" class="hn-comments">
                        {{$descendants}} comment{{if ne $descendants 1}}s{{end}}
                    </a>
                {{end}}
                <span class="hn-separator">|</span>
                <a href="https://news.ycombinator.com/item?id={{replace .Block.ID "hn-" ""}}" target="_blank" class="hn-discuss">discuss</a>
            </div>
        </div>
    </div>

    {{if $itemText}}
    <div class="hn-text">
        <details class="hn-details">
            <summary>Show text</summary>
            <div class="hn-text-content">
                {{truncate $itemText 800}}
            </div>
        </details>
    </div>
    {{end}}

    {{if and $parentID (gt $parentID 0)}}
    <div class="hn-reply-info">
        ↳ Reply to item {{$parentID}}
    </div>
    {{end}}
</div>

<style>
.block-hackernews {
    margin-bottom: 1.5rem;
    padding: 0;
    border: 1px solid var(--border);
    border-radius: 4px;
    background: var(--surface);
    font-family: Verdana, Geneva, sans-serif;
    font-size: 13px;
    line-height: 1.3;
    transition: background .25s ease, border-color .25s ease;
}

.hn-header {
    display: flex;
    gap: 8px;
    padding: 6px 8px;
    background: var(--surface-alt);
    transition: background .25s ease;
}

.hn-header:hover {
    background: var(--surface);
}

.hn-votes {
    display: flex;
    flex-direction: column;
    align-items: center;
    min-width: 35px;
    padding-top: 2px;
}

.vote-score {
    font-size: 12px;
    font-weight: bold;
    color: var(--accent);
    line-height: 1;
}

.vote-label {
    font-size: 8px;
    color: var(--text-dim);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    line-height: 1;
    margin-top: 1px;
}

.vote-placeholder {
    color: var(--border-alt);
    font-size: 14px;
    margin-top: 4px;
}

.hn-content {
    flex: 1;
    min-width: 0;
}

.hn-title {
    margin-bottom: 4px;
    line-height: 1.2;
}

.hn-link {
    color: var(--text);
    text-decoration: none;
    font-size: 14px;
    font-weight: normal;
    transition: color .2s ease;
}

.hn-link:visited {
    color: var(--text-dim);
}

.hn-link:hover {
    text-decoration: underline;
    color: var(--accent);
}

.hn-title-text {
    color: var(--text);
    font-size: 14px;
}

.hn-domain {
    color: var(--text-dim);
    font-size: 11px;
    margin-left: 4px;
}

.hn-domain:before {
    content: "(";
}

.hn-domain:after {
    content: ")";
}

.hn-meta {
    color: var(--text-dim);
    font-size: 11px;
    display: flex;
    align-items: center;
    gap: 6px;
    flex-wrap: wrap;
}

.hn-author {
    font-weight: normal;
}

.hn-time {
    font-variant-numeric: tabular-nums;
}

.hn-separator {
    color: var(--border-alt);
    margin: 0 2px;
}

.hn-comments, .hn-discuss {
    color: var(--text-dim);
    text-decoration: none;
    transition: color .2s ease;
}

.hn-comments:hover, .hn-discuss:hover {
    text-decoration: underline;
    color: var(--accent);
}

.hn-text {
    background: var(--surface-alt);
    padding: 8px;
    border-top: 1px solid var(--border);
}

.hn-details {
    font-size: 12px;
}

.hn-details summary {
    color: var(--text-dim);
    cursor: pointer;
    padding: 4px 0;
    font-weight: normal;
    transition: color .2s ease;
}

.hn-details summary:hover {
    color: var(--text);
}

.hn-details[open] summary {
    margin-bottom: 8px;
    border-bottom: 1px solid var(--border);
    padding-bottom: 8px;
}

.hn-text-content {
    background: var(--surface);
    padding: 12px;
    border: 1px solid var(--border);
    border-radius: 2px;
    color: var(--text);
    font-size: 13px;
    line-height: 1.4;
    white-space: pre-wrap;
    max-height: 300px;
    overflow-y: auto;
}

.hn-reply-info {
    background: var(--surface-alt);
    padding: 6px 8px;
    border-top: 1px solid var(--border);
    color: var(--text-dim);
    font-size: 11px;
    font-style: italic;
}

/* Responsive adjustments */
@media (max-width: 600px) {
    .hn-header {
        padding: 8px 6px;
    }

    .hn-votes {
        min-width: 30px;
    }

    .hn-meta {
        font-size: 10px;
    }

    .hn-domain {
        display: none;
    }
}

/* Better spacing for long titles */
.hn-title {
    word-wrap: break-word;
    overflow-wrap: break-word;
}
</style>
